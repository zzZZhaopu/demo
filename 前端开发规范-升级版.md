# 前端开发设计规范 v2.0

> 通用的前端开发设计标准与最佳实践指南
>
> **版本**: 2.0 | **更新日期**: 2026-01-04

---

## 📖 文档说明

### 适用范围
- ✅ Web 应用开发
- ✅ 移动端 H5 开发
- ✅ 小程序开发
- ✅ 桌面应用(Electron)

### 使用指南
- 🎯 **强制遵循**: 标记为【必须】的规范
- 💡 **建议遵循**: 标记为【建议】的规范
- ⚠️ **特殊场景**: 标记为【视情况】的规范

---

## 目录

- [一、设计价值观与原则](#一设计价值观与原则)
- [二、视觉设计规范](#二视觉设计规范)
- [三、交互设计规范](#三交互设计规范)
- [四、组件设计规范](#四组件设计规范)
- [五、代码开发规范](#五代码开发规范)
- [六、工程化规范](#六工程化规范)
- [七、性能优化规范](#七性能优化规范)
- [八、安全规范](#八安全规范)
- [九、测试规范](#九测试规范)
- [十、团队协作规范](#十团队协作规范)
- [十一、错误处理与日志](#十一错误处理与日志)
- [十二、国际化规范](#十二国际化规范)
- [附录](#附录)

---

## 一、设计价值观与原则

### 1.1 四大设计价值观

#### 🌿 自然 (Natural)
**核心理念**: 追求自然交互，降低用户认知成本

**【必须】感知自然**
- 视觉设计遵循自然界的视觉规律(光影、层次、对比)
- 动画遵循物理规律(加速度、惯性、弹性)
- 界面元素符合现实世界的隐喻

**【必须】行为自然**
- 操作流程符合用户心智模型
- 减少不必要的操作步骤(3-click 原则)
- 提供智能默认值和推荐

**实践建议**:
```typescript
// ✅ 好的做法 - 符合用户预期
<Button onClick={handleSubmit}>保存</Button>

// ❌ 不好的做法 - 术语晦涩
<Button onClick={handleSubmit}>持久化数据</Button>
```

---

#### 🎯 确定性 (Certainty)
**核心理念**: 高确定性、低合作熵

**【必须】设计者确定**
- 保持克制: 能做但想清楚了不做
- 模块化设计: 封装复用，降低复杂度
- 一致性优先: 同一概念使用统一表达

**【必须】用户确定**
- 跨平台一致性: Web/Mobile/小程序保持一致
- 操作可预测: 相同操作产生相同结果
- 状态明确: 始终告知用户当前状态

**反面案例**:
```typescript
// ❌ 不确定性 - 用户不知道发生了什么
function deleteUser(id: string) {
  api.delete(id)
  // 没有任何反馈
}

// ✅ 确定性 - 明确的反馈
async function deleteUser(id: string) {
  try {
    await api.delete(id)
    message.success('删除成功')
    refreshList()
  } catch (error) {
    message.error('删除失败，请重试')
  }
}
```

---

#### 💎 意义感 (Meaningfulness)
**核心理念**: 为工作创造富有意义的体验

**【必须】结果的意义**
- 明确目标: 每个页面都有清晰的主要目标
- 即时反馈: 操作后立即给出反馈(< 100ms)
- 情感化设计: 适当的鼓励和引导

**【建议】过程的意义**
- 难度适中: 不要太简单也不要太复杂
- 减少干扰: 专注核心任务
- 成就反馈: 完成重要操作给予正向反馈

---

#### 🌱 生长性 (Growth)
**核心理念**: 产品和用户共同成长

**【必须】价值连接**
- 新功能的可发现性: 适时的引导和提示
- 渐进披露: 根据用户熟练度展示功能
- 帮助成长: 提供教程、提示、文档

**【建议】灵活扩展**
- 预留扩展点: 组件支持自定义
- 版本兼容: 新版本向下兼容
- 数据迁移: 提供平滑的升级路径

---

### 1.2 十大设计原则

#### 1. 【必须】亲密性原则
- 相关元素在视觉上靠近
- 通过空间距离建立关系
- 间距: 相关8-16px, 不相关24-48px

#### 2. 【必须】对齐原则
- 所有元素基于网格对齐
- 推荐使用8px栅格系统
- 避免任意像素值

#### 3. 【必须】对比原则
- 重要信息加大字号、加粗、使用品牌色
- 次要信息降低透明度、缩小字号
- 对比度至少4.5:1(WCAG AA标准)

#### 4. 【必须】重复原则
- 设计元素在产品中保持一致
- 建立设计系统和组件库
- 统一的视觉语言

#### 5. 【必须】直截了当
- 减少操作步骤(遵循3-click原则)
- 明确的视觉指引
- 避免意外的跳转

#### 6. 【必须】足不出户
- 优先使用对话框、抽屉而非页面跳转
- 保持上下文环境
- 内嵌编辑优于弹窗编辑

#### 7. 【建议】简化交互
- 提供快捷键
- 批量操作
- 智能填充和推荐

#### 8. 【必须】提供邀请
- 功能入口清晰可见
- 首次使用提供引导
- Hover显示操作提示

#### 9. 【建议】巧用过渡
- 动画时长: 200-300ms
- 缓动函数: ease-out(进入), ease-in(退出)
- 避免过度动画影响性能

#### 10. 【必须】即时反应
- 界面响应< 100ms
- 操作反馈< 1s
- 超过1s显示加载状态

---

## 二、视觉设计规范

### 2.1 色彩系统【必须】

#### 主色定义
```scss
// 品牌主色
$primary-color: #1890ff;
$primary-hover: #40a9ff;
$primary-active: #096dd9;

// 功能色
$success-color: #52c41a;
$warning-color: #faad14;
$error-color: #ff4d4f;
$info-color: #1890ff;

// 中性色
$text-primary: rgba(0, 0, 0, 0.88);   // 标题
$text-secondary: rgba(0, 0, 0, 0.65); // 正文
$text-tertiary: rgba(0, 0, 0, 0.45);  // 次要信息
$text-disabled: rgba(0, 0, 0, 0.25);  // 禁用

$border-color: #d9d9d9;
$bg-color: #ffffff;
$bg-light: #fafafa;
```

#### 使用规范
- 【必须】主色占比不超过30%
- 【必须】单页面色彩种类≤5种
- 【必须】对比度符合WCAG AA标准(4.5:1)
- 【建议】支持暗色模式

#### 色彩语义
| 颜色 | 语义 | 使用场景 |
|------|------|----------|
| 蓝色 | 主要、信息 | 主按钮、链接、重要信息 |
| 绿色 | 成功、安全 | 成功提示、通过状态 |
| 黄色 | 警告、注意 | 警告提示、待处理 |
| 红色 | 错误、危险 | 错误提示、删除操作 |
| 灰色 | 中性、禁用 | 禁用状态、次要信息 |

---

### 2.2 布局规范【必须】

#### 栅格系统
- 【必须】使用24栅格系统
- 【必须】容器最大宽度: 1200px
- 【必须】左右边距(gutter): 24px

#### 响应式断点
```scss
$screen-xs: 0;      // 手机竖屏
$screen-sm: 576px;  // 手机横屏
$screen-md: 768px;  // 平板竖屏
$screen-lg: 992px;  // 平板横屏/小屏电脑
$screen-xl: 1200px; // 桌面
$screen-xxl: 1600px;// 大屏桌面
```

#### 间距系统(8px基准)
```scss
$spacing-xs: 4px;
$spacing-sm: 8px;
$spacing-md: 16px;
$spacing-lg: 24px;
$spacing-xl: 32px;
$spacing-xxl: 48px;
```

**间距使用原则**:
- 组件内部: 8-16px
- 组件之间: 16-24px
- 模块之间: 24-48px
- 页面边距: 24px

---

### 2.3 字体排版【必须】

#### 字体家族
```css
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 
             Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 
             sans-serif;
```

#### 字体大小阶梯
```scss
$font-size-xs: 12px;   // 辅助文字
$font-size-sm: 14px;   // 正文(基准)
$font-size-md: 16px;   // 小标题
$font-size-lg: 18px;   // 标题
$font-size-xl: 20px;   // 大标题
$font-size-xxl: 24px;  // 主标题
```

#### 行高规范
- 标题行高: 1.2 - 1.4
- 正文行高: 1.5 - 1.8(推荐1.6)
- 表单行高: 1.5

#### 字重规范
```scss
$font-weight-normal: 400;  // 正文
$font-weight-medium: 500;  // 强调
$font-weight-semibold: 600;// 标题
```

---

### 2.4 图标规范【必须】

#### 图标尺寸
- 【必须】基础尺寸: 16px × 16px
- 【必须】常用尺寸: 12px, 14px, 16px, 20px, 24px
- 【必须】最小点击区域: 44px × 44px

#### 图标风格
- 【必须】风格统一(线性/面性)
- 【必须】线条粗细一致(1.5-2px)
- 【必须】圆角统一(2px或无圆角)

#### 使用规范
```tsx
// ✅ 好的做法
<Button icon={<SaveOutlined />}>保存</Button>

// ✅ 带提示
<Tooltip title="保存">
  <Button icon={<SaveOutlined />} />
</Tooltip>

// ❌ 避免 - 无文字无提示
<Button icon={<SaveOutlined />} />
```

---

### 2.5 阴影规范【必须】

#### 四层阴影系统
```scss
// 第0层: 贴地(无阴影)
$shadow-none: none;

// 第1层: 低层级(hover卡片)
$shadow-sm: 0 1px 2px -2px rgba(0,0,0,0.16),
            0 3px 6px 0 rgba(0,0,0,0.12),
            0 5px 12px 4px rgba(0,0,0,0.09);

// 第2层: 中层级(下拉菜单)
$shadow-md: 0 3px 6px -4px rgba(0,0,0,0.12),
            0 6px 16px 0 rgba(0,0,0,0.08),
            0 9px 28px 8px rgba(0,0,0,0.05);

// 第3层: 高层级(对话框)
$shadow-lg: 0 6px 16px -8px rgba(0,0,0,0.08),
            0 9px 28px 0 rgba(0,0,0,0.05),
            0 12px 48px 16px rgba(0,0,0,0.03);
```

---

### 2.6 圆角规范【必须】

```scss
$border-radius-sm: 2px;  // 小元素(Tag, Badge)
$border-radius-md: 4px;  // 常规元素(Button, Input)
$border-radius-lg: 8px;  // 大元素(Card, Modal)
$border-radius-xl: 16px; // 特殊元素
```

---

## 三、交互设计规范

### 3.1 反馈机制【必须】

#### 操作反馈时长
| 操作类型 | 反馈时长 | 处理方式 |
|---------|---------|----------|
| 即时操作 | < 100ms | 无需反馈 |
| 快速操作 | 100ms-1s | 按钮loading |
| 一般操作 | 1s-3s | 显示进度 |
| 长时操作 | > 3s | 进度条+可中断 |

#### 反馈类型
```tsx
// 成功反馈
message.success('操作成功')

// 错误反馈(说明原因+解决方案)
message.error('保存失败: 网络连接超时，请检查网络后重试')

// 警告反馈
message.warning('该操作将影响其他关联数据')

// 信息反馈
message.info('数据已自动保存')
```

---

### 3.2 加载状态【必须】

#### 加载策略
```tsx
// 【必须】全局加载 - 阻塞操作
const loading = useLoading()
loading.show('加载中...')

// 【必须】局部加载 - 不阻塞其他区域
<Spin spinning={loading}>
  <Content />
</Spin>

// 【建议】骨架屏 - 首屏加载
<Skeleton loading={loading} active>
  <Content />
</Skeleton>

// 【建议】乐观更新 - 提升体验
const handleLike = () => {
  // 先更新UI
  setLiked(true)
  // 后调用API
  api.like().catch(() => setLiked(false))
}
```

---

### 3.3 错误处理【必须】

#### 错误分类
1. **表单错误**: 字段下方显示错误信息
2. **操作错误**: Message/Notification提示
3. **页面错误**: 错误页面(404, 500)
4. **网络错误**: 重试机制

```tsx
// 表单错误
<Form.Item
  name="email"
  rules={[
    { required: true, message: '请输入邮箱' },
    { type: 'email', message: '邮箱格式不正确' }
  ]}
>
  <Input />
</Form.Item>

// 操作错误
try {
  await api.delete(id)
} catch (error) {
  if (error.code === 'PERMISSION_DENIED') {
    message.error('无权限删除此项')
  } else {
    message.error('删除失败，请重试')
  }
}

// 全局错误处理
window.addEventListener('unhandledrejection', (event) => {
  console.error('未处理的Promise错误:', event.reason)
  message.error('系统异常，请刷新页面')
})
```

---

### 3.4 表单交互【必须】

#### 表单布局
- 【必须】单列布局(推荐)
- 【视情况】双列布局(关联性强时)
- 【必须】标签位置: 右对齐或顶对齐

#### 表单验证
```tsx
// 【必须】即时验证
<Form.Item
  name="password"
  rules={[
    { required: true, message: '请输入密码' },
    { min: 6, message: '密码至少6位' },
    { 
      validator: (_, value) => {
        if (value && !/[A-Z]/.test(value)) {
          return Promise.reject('密码必须包含大写字母')
        }
        return Promise.resolve()
      }
    }
  ]}
>
  <Input.Password />
</Form.Item>

// 【必须】提交前验证
const handleSubmit = async (values) => {
  try {
    await form.validateFields()
    await api.submit(values)
    message.success('提交成功')
  } catch (error) {
    message.error('请检查表单填写')
  }
}
```

#### 表单优化
- 【建议】提供默认值
- 【建议】智能填充(如自动补全)
- 【必须】清除按钮
- 【建议】保存草稿

---

### 3.5 导航设计【必须】

#### 导航类型选择
| 导航类型 | 适用场景 | 特点 |
|---------|---------|------|
| 顶部导航 | 扁平结构 | 一级导航,≤7个 |
| 侧边导航 | 树形结构 | 多级导航 |
| 面包屑 | 层级深 | 显示路径 |
| 标签页 | 同级内容 | 快速切换 |

#### 导航原则
- 【必须】当前位置高亮
- 【必须】层级不超过3层
- 【建议】支持快捷键(如搜索)

---

### 3.6 数据展示【必须】

#### 表格设计
```tsx
// 【必须】固定重要列
<Table
  columns={[
    { title: 'ID', dataIndex: 'id', width: 80, fixed: 'left' },
    { title: '操作', dataIndex: 'actions', width: 150, fixed: 'right' }
  ]}
  scroll={{ x: 1200 }}
/>

// 【必须】分页
<Table
  pagination={{
    total: 100,
    pageSize: 10,
    showSizeChanger: true,
    showQuickJumper: true,
    showTotal: (total) => `共 ${total} 条`
  }}
/>

// 【建议】批量操作
const [selectedKeys, setSelectedKeys] = useState([])

<Table
  rowSelection={{
    selectedRowKeys: selectedKeys,
    onChange: setSelectedKeys
  }}
/>
```

---

## 四、组件设计规范

### 4.1 按钮【必须】

#### 按钮类型
```tsx
// 主按钮 - 页面主要操作
<Button type="primary">提交</Button>

// 次按钮 - 次要操作
<Button>取消</Button>

// 文字按钮 - 弱化操作
<Button type="link">查看详情</Button>

// 危险按钮 - 危险操作
<Button danger>删除</Button>
```

#### 按钮规范
- 【必须】最小高度32px
- 【必须】主按钮在右,次按钮在左
- 【必须】使用动词(保存/提交/确认)
- 【建议】Loading状态

```tsx
// ✅ 好的做法
<Space>
  <Button onClick={onCancel}>取消</Button>
  <Button type="primary" loading={loading} onClick={onSubmit}>
    提交
  </Button>
</Space>

// ❌ 不好的做法
<Space>
  <Button type="primary">确定</Button>
  <Button>取消</Button>
</Space>
```

---

### 4.2 输入框【必须】

#### 输入框规范
```tsx
// 【必须】占位符提示
<Input placeholder="请输入用户名" />

// 【必须】清除按钮
<Input allowClear />

// 【建议】前缀图标
<Input prefix={<UserOutlined />} />

// 【建议】字数限制
<Input maxLength={20} showCount />
```

---

### 4.3 对话框【必须】

#### 对话框尺寸
```scss
$modal-sm: 520px;
$modal-md: 720px;
$modal-lg: 960px;
```

#### 使用规范
```tsx
// 【必须】标题明确
<Modal title="删除确认">
  
// 【必须】内容清晰
  <p>确定要删除用户"张三"吗？删除后无法恢复。</p>

// 【必须】操作按钮明确
  <Button onClick={onCancel}>取消</Button>
  <Button type="primary" danger onClick={onConfirm}>
    确认删除
  </Button>
</Modal>

// 【建议】支持ESC关闭
<Modal onCancel={onClose} keyboard />

// 【建议】支持遮罩关闭
<Modal onCancel={onClose} maskClosable />
```

---

### 4.4 消息提示【必须】

#### Message vs Notification
| 组件 | 位置 | 时长 | 使用场景 |
|------|------|------|----------|
| Message | 顶部居中 | 3s | 轻量反馈 |
| Notification | 右上角 | 4.5s | 系统通知 |

```tsx
// Message - 操作反馈
message.success('保存成功')
message.error('保存失败')

// Notification - 系统通知
notification.info({
  message: '系统通知',
  description: '您有一条新消息',
  duration: 4.5
})
```

---

## 五、代码开发规范

### 5.1 HTML规范【必须】

#### 语义化标签
```html
<!-- ✅ 好的做法 -->
<header>页头</header>
<nav>导航</nav>
<main>
  <article>文章</article>
  <aside>侧边栏</aside>
</main>
<footer>页脚</footer>

<!-- ❌ 不好的做法 -->
<div class="header">页头</div>
<div class="nav">导航</div>
<div class="main">内容</div>
```

#### 无障碍
```html
<!-- 【必须】图片alt -->
<img src="logo.png" alt="公司Logo" />

<!-- 【必须】表单label -->
<label for="username">用户名</label>
<input id="username" name="username" />

<!-- 【必须】ARIA属性 -->
<button aria-label="关闭">×</button>
```

---

### 5.2 CSS规范【必须】

#### 命名规范(BEM)
```scss
// 【必须】BEM命名
.block {}
.block__element {}
.block--modifier {}

// 示例
.card {}
.card__header {}
.card__body {}
.card--primary {}
```

#### CSS组织
```scss
// 【必须】变量定义
:root {
  --primary-color: #1890ff;
  --spacing-md: 16px;
}

// 【建议】使用CSS Modules
.container {
  padding: var(--spacing-md);
  color: var(--primary-color);
}

// 【必须】移动端优先
.container {
  width: 100%;
  
  @media (min-width: 768px) {
    width: 750px;
  }
  
  @media (min-width: 1200px) {
    width: 1170px;
  }
}
```

---

### 5.3 JavaScript/TypeScript规范【必须】

#### 命名规范
```typescript
// 【必须】变量使用camelCase
const userName = 'John'
const isActive = true

// 【必须】常量使用UPPER_CASE
const MAX_COUNT = 100
const API_URL = 'https://api.example.com'

// 【必须】类使用PascalCase
class UserService {}

// 【必须】私有变量使用_前缀
class Example {
  private _privateVar = 'private'
}

// 【必须】布尔值使用is/has/can前缀
const isLoading = false
const hasPermission = true
const canEdit = false
```

#### 函数规范
```typescript
// 【必须】函数名使用动词
function getUser() {}
function setData() {}
function validateForm() {}

// 【必须】单一职责
// ✅ 好的做法
function getUserById(id: string) {
  return users.find(u => u.id === id)
}

function formatUserName(user: User) {
  return `${user.firstName} ${user.lastName}`
}

// ❌ 不好的做法
function getUserAndFormat(id: string) {
  const user = users.find(u => u.id === id)
  return `${user.firstName} ${user.lastName}`
}
```

#### TypeScript类型
```typescript
// 【必须】接口定义
interface User {
  id: string
  name: string
  email: string
  role: 'admin' | 'user'
}

// 【必须】类型导出
export type { User }

// 【建议】使用泛型
function request<T>(url: string): Promise<T> {
  return fetch(url).then(res => res.json())
}

// 【必须】避免any
// ❌ 不好的做法
function handle(data: any) {}

// ✅ 好的做法
function handle(data: unknown) {
  if (typeof data === 'string') {
    // 类型收窄
  }
}
```

---

### 5.4 React/Vue规范【必须】

#### React组件
```tsx
// 【必须】函数组件
interface Props {
  title: string
  onClose: () => void
}

const MyComponent: React.FC<Props> = ({ title, onClose }) => {
  // 【必须】Hooks在顶层
  const [state, setState] = useState('')
  
  // 【建议】useCallback优化
  const handleClick = useCallback(() => {
    // ...
  }, [])
  
  // 【必须】提前return
  if (!title) {
    return null
  }
  
  return (
    <div>
      <h1>{title}</h1>
      <button onClick={onClose}>关闭</button>
    </div>
  )
}
```

#### Vue组件
```vue
<script setup lang="ts">
// 【必须】TypeScript
interface Props {
  title: string
}

const props = defineProps<Props>()
const emit = defineEmits<{
  close: []
}>()

// 【必须】响应式
const count = ref(0)
const doubled = computed(() => count.value * 2)

// 【建议】生命周期
onMounted(() => {
  // 初始化
})

onUnmounted(() => {
  // 清理
})
</script>

<template>
  <div>
    <h1>{{ title }}</h1>
    <button @click="emit('close')">关闭</button>
  </div>
</template>

<style scoped>
/* 【必须】scoped样式 */
</style>
```

---

### 5.5 状态管理【建议】

#### Redux/Zustand
```typescript
// 【建议】状态分片
interface AppState {
  user: UserState
  cart: CartState
}

// 【必须】不可变更新
const reducer = (state, action) => {
  switch (action.type) {
    case 'ADD':
      // ✅ 返回新对象
      return { ...state, count: state.count + 1 }
    default:
      return state
  }
}

// 【建议】使用Redux Toolkit
const counterSlice = createSlice({
  name: 'counter',
  initialState: { value: 0 },
  reducers: {
    increment: state => {
      state.value += 1 // Immer处理
    }
  }
})
```

---

## 六、工程化规范

### 6.1 项目结构【必须】

```
src/
├── assets/          # 静态资源
│   ├── images/
│   ├── fonts/
│   └── styles/
├── components/      # 通用组件
│   ├── Button/
│   │   ├── index.tsx
│   │   ├── Button.module.scss
│   │   └── Button.test.tsx
│   └── index.ts
├── hooks/           # 自定义Hooks
├── pages/           # 页面组件
├── services/        # API服务
├── store/           # 状态管理
├── types/           # 类型定义
├── utils/           # 工具函数
├── constants/       # 常量
├── config/          # 配置文件
├── App.tsx
└── main.tsx
```

---

### 6.2 Git工作流【必须】

#### 分支策略
```bash
main/master    # 生产环境
develop        # 开发环境
feature/*      # 功能分支
hotfix/*       # 紧急修复
release/*      # 发布分支
```

#### Commit规范
```bash
# 【必须】使用约定式提交
feat: 新增用户管理功能
fix: 修复登录按钮无响应问题
docs: 更新README文档
style: 格式化代码
refactor: 重构用户服务
perf: 优化列表渲染性能
test: 添加登录功能测试
chore: 更新依赖包

# 【建议】详细描述
feat: 新增用户管理功能

- 添加用户列表页面
- 实现用户增删改查
- 集成权限控制
```

---

### 6.3 代码审查【必须】

#### 审查清单
- [ ] 代码符合规范
- [ ] 无console.log等调试代码
- [ ] 无硬编码
- [ ] 异常处理完善
- [ ] 性能优化(避免不必要的渲染)
- [ ] 安全检查(XSS/CSRF)
- [ ] 测试用例充分
- [ ] 文档完善

---

### 6.4 构建优化【必须】

#### Vite配置
```typescript
// vite.config.ts
export default defineConfig({
  build: {
    // 【必须】代码分割
    rollupOptions: {
      output: {
        manualChunks: {
          'react-vendor': ['react', 'react-dom'],
          'antd': ['antd']
        }
      }
    },
    // 【必须】压缩
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true
      }
    }
  }
})
```

---

## 七、性能优化规范

### 7.1 加载性能【必须】

#### 性能指标
| 指标 | 目标 | 说明 |
|------|------|------|
| FCP | < 1.8s | 首次内容绘制 |
| LCP | < 2.5s | 最大内容绘制 |
| FID | < 100ms | 首次输入延迟 |
| CLS | < 0.1 | 累计布局偏移 |

#### 优化策略
```typescript
// 【必须】路由懒加载
const Home = lazy(() => import('./pages/Home'))

// 【必须】组件懒加载
const HeavyComponent = lazy(() => import('./components/HeavyComponent'))

// 【必须】图片懒加载
<img loading="lazy" src="image.jpg" />

// 【建议】预加载关键资源
<link rel="preload" href="font.woff2" as="font" />

// 【建议】DNS预解析
<link rel="dns-prefetch" href="https://api.example.com" />
```

---

### 7.2 运行性能【必须】

#### React优化
```tsx
// 【必须】useMemo缓存计算结果
const expensiveValue = useMemo(() => {
  return computeExpensiveValue(a, b)
}, [a, b])

// 【必须】useCallback缓存函数
const handleClick = useCallback(() => {
  doSomething(a, b)
}, [a, b])

// 【必须】React.memo避免重渲染
const MemoComponent = React.memo(({ data }) => {
  return <div>{data}</div>
})

// 【建议】虚拟列表
<VirtualList
  data={largeData}
  itemHeight={50}
  height={600}
/>
```

#### 防抖节流
```typescript
// 【必须】搜索防抖
const handleSearch = debounce((value: string) => {
  search(value)
}, 300)

// 【必须】滚动节流
const handleScroll = throttle(() => {
  checkPosition()
}, 100)
```

---

### 7.3 打包优化【必须】

```typescript
// 【必须】Tree Shaking
import { debounce } from 'lodash-es' // ✅
import _ from 'lodash' // ❌

// 【必须】动态导入
if (condition) {
  import('./heavy-module').then(module => {
    module.doSomething()
  })
}

// 【建议】CDN加载
// vite.config.ts
export default {
  build: {
    rollupOptions: {
      external: ['react', 'react-dom'],
      output: {
        globals: {
          react: 'React',
          'react-dom': 'ReactDOM'
        }
      }
    }
  }
}
```

---

## 八、安全规范

### 8.1 XSS防护【必须】

```tsx
// 【必须】转义用户输入
// ✅ React自动转义
<div>{userInput}</div>

// ⚠️ 危险的HTML
<div dangerouslySetInnerHTML={{ __html: sanitizedHTML }} />

// 【必须】使用DOMPurify
import DOMPurify from 'dompurify'
const clean = DOMPurify.sanitize(dirty)

// 【必须】CSP策略
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; script-src 'self' 'unsafe-inline'" />
```

---

### 8.2 CSRF防护【必须】

```typescript
// 【必须】CSRF Token
axios.defaults.headers.common['X-CSRF-TOKEN'] = getCsrfToken()

// 【必须】SameSite Cookie
Set-Cookie: sessionId=xxx; SameSite=Strict; Secure; HttpOnly
```

---

### 8.3 数据安全【必须】

```typescript
// 【必须】敏感数据不存localStorage
// ❌ 不要这样做
localStorage.setItem('password', password)

// ✅ 使用HttpOnly Cookie
// 由服务端设置

// 【必须】HTTPS
if (location.protocol !== 'https:' && ENV === 'production') {
  location.href = 'https:' + location.href.substring(location.protocol.length)
}

// 【必须】输入验证
function validateEmail(email: string): boolean {
  const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
  return regex.test(email)
}
```

---

## 九、测试规范

### 9.1 单元测试【建议】

```typescript
// 【建议】测试覆盖率 > 80%
// jest.config.js
export default {
  coverageThreshold: {
    global: {
      statements: 80,
      branches: 80,
      functions: 80,
      lines: 80
    }
  }
}

// 【必须】测试工具函数
describe('formatDate', () => {
  it('should format date correctly', () => {
    const date = new Date('2024-01-01')
    expect(formatDate(date)).toBe('2024-01-01')
  })
  
  it('should handle invalid date', () => {
    expect(formatDate(null)).toBe('')
  })
})
```

---

### 9.2 组件测试【建议】

```tsx
// 【建议】使用React Testing Library
import { render, screen, fireEvent } from '@testing-library/react'

describe('Button', () => {
  it('should render correctly', () => {
    render(<Button>Click me</Button>)
    expect(screen.getByText('Click me')).toBeInTheDocument()
  })
  
  it('should call onClick when clicked', () => {
    const handleClick = jest.fn()
    render(<Button onClick={handleClick}>Click</Button>)
    fireEvent.click(screen.getByText('Click'))
    expect(handleClick).toHaveBeenCalledTimes(1)
  })
})
```

---

### 9.3 E2E测试【建议】

```typescript
// 【建议】关键流程E2E测试
// Playwright
test('user login flow', async ({ page }) => {
  await page.goto('https://example.com/login')
  await page.fill('#username', 'testuser')
  await page.fill('#password', 'password')
  await page.click('button[type="submit"]')
  await expect(page).toHaveURL('https://example.com/dashboard')
})
```

---

## 十、团队协作规范

### 10.1 文档规范【必须】

#### README.md
```markdown
# 项目名称

## 简介
项目简短描述

## 技术栈
- React 18
- TypeScript
- Ant Design

## 快速开始
\`\`\`bash
npm install
npm run dev
\`\`\`

## 项目结构
\`\`\`
src/
├── components/
├── pages/
└── ...
\`\`\`

## 开发规范
请参考 [开发规范文档](./docs/GUIDELINES.md)

## 部署
\`\`\`bash
npm run build
\`\`\`
```

#### 组件文档
```tsx
/**
 * 按钮组件
 * 
 * @example
 * ```tsx
 * <Button type="primary" onClick={handleClick}>
 *   提交
 * </Button>
 * ```
 */
interface ButtonProps {
  /** 按钮类型 */
  type?: 'primary' | 'default' | 'link'
  /** 按钮大小 */
  size?: 'small' | 'middle' | 'large'
  /** 点击事件 */
  onClick?: () => void
}
```

---

### 10.2 代码注释【必须】

```typescript
// 【必须】函数注释
/**
 * 格式化日期
 * @param date - 日期对象
 * @param format - 格式化模板
 * @returns 格式化后的字符串
 * @example
 * formatDate(new Date(), 'YYYY-MM-DD') // '2024-01-01'
 */
function formatDate(date: Date, format: string): string {
  // 实现
}

// 【必须】复杂逻辑注释
// 计算用户等级折扣
// 1. 普通用户: 无折扣
// 2. VIP用户: 9折
// 3. SVIP用户: 8折
const discount = calculateDiscount(user.level)

// 【建议】TODO注释
// TODO: 优化性能 - 使用虚拟滚动
// FIXME: 修复IE兼容问题
// HACK: 临时方案，等API更新后移除
```

---

### 10.3 版本管理【必须】

#### 语义化版本
```
主版本.次版本.修订号
MAJOR.MINOR.PATCH

1.0.0 - 初始版本
1.1.0 - 新增功能
1.1.1 - Bug修复
2.0.0 - 破坏性变更
```

#### CHANGELOG
```markdown
# Changelog

## [1.2.0] - 2024-01-04

### Added
- 新增用户管理功能
- 添加数据导出功能

### Changed
- 优化列表加载性能
- 更新UI设计

### Fixed
- 修复登录失败问题
- 解决IE兼容性问题
```

---

## 十一、错误处理与日志

### 11.1 错误边界【必须】

```tsx
// React错误边界
class ErrorBoundary extends React.Component {
  state = { hasError: false }
  
  static getDerivedStateFromError() {
    return { hasError: true }
  }
  
  componentDidCatch(error, errorInfo) {
    // 【必须】上报错误
    logError(error, errorInfo)
  }
  
  render() {
    if (this.state.hasError) {
      return <ErrorPage />
    }
    return this.props.children
  }
}
```

---

### 11.2 日志规范【必须】

```typescript
// 【必须】日志级别
enum LogLevel {
  DEBUG,
  INFO,
  WARN,
  ERROR
}

// 【必须】结构化日志
logger.info('User login', {
  userId: '123',
  timestamp: Date.now(),
  userAgent: navigator.userAgent
})

// 【必须】生产环境过滤
if (ENV === 'production') {
  console.log = () => {}
  console.debug = () => {}
}
```

---

## 十二、国际化规范

### 12.1 i18n配置【建议】

```typescript
// 【建议】使用i18next
import i18n from 'i18next'

i18n.init({
  lng: 'zh-CN',
  resources: {
    'zh-CN': {
      translation: {
        'welcome': '欢迎',
        'login': '登录'
      }
    },
    'en-US': {
      translation: {
        'welcome': 'Welcome',
        'login': 'Login'
      }
    }
  }
})

// 【建议】使用
const { t } = useTranslation()
<h1>{t('welcome')}</h1>
```

---

### 12.2 多语言规范【建议】

```typescript
// 【建议】文案抽取
// ❌ 不好的做法
<Button>删除</Button>

// ✅ 好的做法
<Button>{t('common.delete')}</Button>

// 【建议】参数化
t('user.welcome', { name: userName })
// zh: 欢迎，{name}
// en: Welcome, {name}

// 【建议】复数处理
t('items.count', { count: 5 })
// zh: 5个项目
// en: 5 items
```

---

## 附录

### A. 常用工具库推荐

#### 工具类
- **lodash-es**: 工具函数(Tree-shaking友好)
- **dayjs**: 日期处理
- **axios**: HTTP请求
- **zod**: 数据验证

#### React生态
- **zustand**: 轻量状态管理
- **react-query**: 数据获取
- **react-hook-form**: 表单处理
- **framer-motion**: 动画

#### Vue生态
- **pinia**: 状态管理
- **vueuse**: 组合式工具
- **vee-validate**: 表单验证

---

### B. 浏览器兼容性

| 浏览器 | 最低版本 |
|--------|----------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

**【必须】polyfill**
```typescript
import 'core-js/stable'
import 'regenerator-runtime/runtime'
```

---

### C. 性能检查清单

- [ ] 首屏加载时间 < 2s
- [ ] 路由懒加载
- [ ] 图片懒加载
- [ ] 代码分割
- [ ] Tree Shaking
- [ ] 压缩资源
- [ ] CDN部署
- [ ] 缓存策略
- [ ] 虚拟列表(长列表)
- [ ] 防抖节流

---

### D. 上线检查清单

- [ ] 移除console.log
- [ ] 移除debugger
- [ ] 错误监控配置
- [ ] 性能监控配置
- [ ] SEO优化(meta标签)
- [ ] 安全配置(CSP/HTTPS)
- [ ] 浏览器兼容性测试
- [ ] 移动端适配测试
- [ ] 无障碍测试
- [ ] 备份数据库

---

### E. 学习资源

#### 官方文档
- [React](https://react.dev/)
- [Vue](https://vuejs.org/)
- [TypeScript](https://www.typescriptlang.org/)
- [Ant Design](https://ant.design/)

#### 推荐书籍
- 《重构：改善既有代码的设计》
- 《代码整洁之道》
- 《JavaScript高级程序设计》
- 《深入浅出Vue.js》

#### 工具网站
- [Can I Use](https://caniuse.com/) - 浏览器兼容性
- [BundlePhobia](https://bundlephobia.com/) - 包大小分析
- [WebPageTest](https://www.webpagetest.org/) - 性能测试

---

## 版本历史

### v2.0 (2026-01-04)
- 新增工程化规范章节
- 新增安全规范章节
- 新增测试规范章节
- 新增团队协作规范
- 新增错误处理与日志
- 新增国际化规范
- 补充代码示例
- 添加检查清单

### v1.0 (2026-01-03)
- 初始版本
- 设计价值观
- 视觉设计规范
- 交互设计规范
- 组件设计规范

---

## 贡献指南

欢迎提交Issue和PR来完善本规范。

## 许可证

MIT License

---

**维护团队**: 前端开发团队  
**最后更新**: 2026-01-04
