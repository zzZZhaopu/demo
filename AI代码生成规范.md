# AI 代码生成规范

> **用途**: 框架无关的前端开发设计规范，适用于所有主流框架
> **原则**: 规则明确、框架中立、注重通用性

---

## 规则优先级

- ⚠️ **CRITICAL** - 必须遵守，违反导致严重问题
- 🔴 **MUST** - 强制执行
- 🟡 **SHOULD** - 强烈建议
- 🟢 **OPTIONAL** - 可选

---

## 一、视觉设计规则

### 1.1 色彩系统 🔴

**标准色彩分类**:
- 品牌主色: 1个核心颜色 + hover/active 状态变体
- 功能色: 成功(绿)、警告(黄)、错误(红)、信息(蓝)
- 文字色: 主要(88%黑)、次要(65%黑)、辅助(45%黑)、禁用(25%黑)
- 中性色: 边框、背景、分割线

**使用规则**:
- ⚠️ 文字对比度 ≥ 4.5:1 (WCAG AA 标准)
- 🔴 单页面主色占比 ≤ 30%
- 🔴 单页面色彩种类 ≤ 5 种
- 🔴 同一功能在不同页面使用相同颜色

### 1.2 间距系统 🔴

**8px 基准间距阶梯**:
- 4px (极小) → 8px (小) → 16px (中) → 24px (大) → 32px (特大) → 48px (超大)

**使用场景**:
- 组件内部: 8-16px
- 组件之间: 16-24px
- 模块之间: 24-48px
- 页面边距: 24px

**核心规则**:
- ⚠️ 所有间距必须是 8 的倍数
- 🔴 相关元素间距小，不相关元素间距大
- 🔴 禁止使用任意像素值 (如 13px, 27px)
- 🟡 重要内容留白更充分

### 1.3 字体系统 🔴

**字号阶梯**:
- 12px (辅助) → 14px (正文基准) → 16px (小标题) → 18px (标题) → 20px (大标题) → 24px (主标题)

**行高规范**:
- 标题: 1.2-1.4
- 正文: 1.5-1.8 (推荐 1.6)
- 表单: 1.5

**字重规范**:
- 400 (正文) → 500 (强调) → 600 (标题)

**核心规则**:
- ⚠️ 最小字号 ≥ 12px
- 🔴 正文基准使用 14px
- 🔴 同一层级标题字号统一

### 1.4 圆角与阴影 🟡

**圆角规范**:
- 2px (小元素) → 4px (常规) → 8px (大元素) → 16px (特殊)
- 同一界面圆角值保持一致

**阴影层级**:
- 第1层: 轻量悬浮 (卡片 hover)
- 第2层: 中度悬浮 (下拉菜单)
- 第3层: 高度悬浮 (对话框)
- 阴影方向全局统一

---

## 二、布局规则

### 2.1 栅格系统 🔴

**栅格规范**:
- 使用 12 或 24 栅格系统
- 栅格间距: 16px 或 24px

**响应式断点 (推荐)**:
- xs: < 576px (手机)
- sm: ≥ 576px (大屏手机)
- md: ≥ 768px (平板)
- lg: ≥ 992px (桌面)
- xl: ≥ 1200px (大屏)
- xxl: ≥ 1600px (超大屏)

**核心规则**:
- 🔴 页面最大宽度 1200px
- 🔴 移动端优先设计
- 🔴 断点数量 ≤ 6 个

### 2.2 对齐规则 🔴

- ⚠️ 所有元素基于 8px 网格对齐
- 🔴 元素边缘与网格线对齐
- 🔴 相关元素视觉上靠近
- 🔴 文本左对齐或两端对齐 (避免居中大段文字)

### 2.3 层次规则 🔴

**建立视觉层次的方法**:
- 大小对比 (字号、组件尺寸)
- 颜色对比 (主色、灰色)
- 字重对比 (粗体、常规)
- 间距对比 (紧密、疏松)

**核心规则**:
- 🔴 主要信息突出 (大、粗、彩色)
- 🔴 次要信息弱化 (小、细、灰色)
- 🔴 层级不超过 3 层

---

## 三、组件设计规则

### 3.1 按钮 🔴

**位置规则**:
- ⚠️ 主按钮在右，次按钮在左
- 🔴 对话框: 确定在右，取消在左
- 🔴 表单: 提交在右，取消/重置在左

**文案规则**:
- 🔴 使用明确的动词 (保存/提交/删除/确认)
- 🔴 避免模糊表达 (好的/确定)

**样式规则**:
- 🔴 最小高度 32px
- 🔴 最小点击区域 44px × 44px (移动端)
- 🔴 危险操作醒目标识 (红色/警告图标)

**状态规则**:
- ⚠️ 异步操作必须显示 loading 状态
- 🔴 禁用状态降低透明度至 50%
- 🔴 加载时禁用点击

### 3.2 表单 🔴

**布局规则**:
- 🔴 推荐单列布局 (视线流畅)
- 🟡 双列布局需确保字段相关性
- 🔴 标签位置: 右对齐或顶对齐
- 🔴 标签宽度一致

**交互规则**:
- ⚠️ 必填项明确标识 (* 号或文字)
- 🔴 即时验证 (失焦时或输入时)
- 🔴 错误提示在字段下方
- 🔴 提供占位符文本
- 🟡 提供清除按钮

**验证规则**:
- ⚠️ 提交前整表验证
- 🔴 错误信息说明原因 + 解决方法
- 🔴 成功后给予明确反馈

**优化建议**:
- 🟡 提供默认值
- 🟡 智能填充 (自动补全)
- 🟡 最小化必填项

### 3.3 表格 🔴

**列设计**:
- 🔴 重要列固定在左侧
- 🔴 操作列固定在最右侧
- 🔴 列宽: 重要列固定宽度，次要列自适应
- 🟡 数值列右对齐，文本列左对齐

**分页规则**:
- ⚠️ 数据 > 10 条必须分页
- 🔴 默认每页 10/20/50 条
- 🔴 显示总数和当前范围
- 🟡 支持切换每页数量

**交互规则**:
- 🔴 批量操作放在表格上方
- 🔴 行操作放在行尾
- 🟡 支持排序和筛选
- 🟡 提供搜索功能

**性能规则**:
- 🔴 数据 > 100 条使用虚拟滚动
- 🟡 默认加载部分数据

### 3.4 对话框 🔴

**尺寸规范**:
- 小: 420-520px (简单确认)
- 中: 720px (表单)
- 大: 960px (复杂内容)

**内容规则**:
- 🔴 标题明确表达目的
- 🔴 内容简洁，避免长文
- 🔴 重要信息前置
- 🔴 按钮文字使用动词

**交互规则**:
- 🔴 提供关闭按钮 (× 或取消)
- 🟡 支持 ESC 键关闭
- 🟡 支持点击遮罩关闭 (非强制场景)
- 🔴 危险操作二次确认

**原则**:
- 🔴 足不出户: 避免对话框套对话框
- 🔴 避免滚动: 内容过多考虑新页面

### 3.5 消息反馈 🔴

**反馈类型选择**:
- 轻量反馈: Toast/Message (顶部居中, 3秒)
- 系统通知: Notification (右上角, 4.5秒)
- 重要确认: 对话框

**文案规则**:
- 🔴 成功: 简短确认 ("保存成功")
- 🔴 错误: 原因 + 解决方案 ("保存失败: 网络超时，请重试")
- 🔴 警告: 说明影响 ("此操作将影响关联数据")
- 🔴 信息: 简洁说明

**时长规则**:
- 成功/信息: 3秒
- 警告: 4秒
- 错误: 5秒或手动关闭
- 重要通知: 不自动关闭

---

## 四、交互规则

### 4.1 响应时间 ⚠️

**时间阈值**:
- < 100ms: 瞬时响应，无需反馈
- 100ms - 1s: 按钮显示 loading
- 1s - 3s: 显示加载提示
- \> 3s: 显示进度条

**核心规则**:
- ⚠️ 界面响应 < 100ms
- ⚠️ 操作超过 1s 必须有加载状态
- 🔴 所有操作必须有反馈
- 🔴 长时操作可中断

### 4.2 加载状态 ⚠️

**加载策略**:
- 全局加载: 阻塞整个页面 (页面切换)
- 局部加载: 仅阻塞操作区域 (按钮、表单)
- 骨架屏: 首屏加载
- 进度条: 上传、导出等

**核心规则**:
- ⚠️ 所有异步操作必须有加载状态
- ⚠️ 加载时禁用操作控件
- 🔴 加载失败提供重试机制
- 🟡 预估时间 > 5s 显示进度百分比

### 4.3 错误处理 ⚠️

**错误分类**:
- 表单错误: 字段下方提示
- 操作错误: Toast/Message 提示
- 页面错误: 错误页面 (404, 500)
- 网络错误: 重试 + 提示

**错误信息规范**:
- ⚠️ 说明错误原因
- ⚠️ 提供解决方案
- 🔴 使用用户理解的语言 (避免技术术语)
- 🔴 提供重试或撤销操作

**核心规则**:
- ⚠️ 所有异步操作必须错误处理
- 🔴 不暴露技术细节给用户
- 🔴 关键错误记录日志

---

## 五、代码规范

### 5.1 命名规范 🔴

**命名风格**:
- 变量/函数: camelCase (userName, getUserById)
- 类/组件: PascalCase (UserService, UserList)
- 常量: UPPER_CASE (MAX_COUNT, API_URL)
- 私有属性: _前缀 (_privateData)

**语义规范**:
- 🔴 函数名使用动词开头 (get/set/handle/fetch/create/update/delete)
- 🔴 布尔值使用 is/has/can 前缀 (isActive, hasPermission, canEdit)
- 🔴 避免缩写 (除非公认: btn → button)
- 🔴 名称要表意，避免 a/b/temp/data

**文件命名**:
- 组件文件: PascalCase (UserList.tsx)
- 工具文件: camelCase (formatDate.ts)
- 样式文件: kebab-case (user-list.css)

### 5.2 组件结构 🔴

**标准结构顺序**:
1. 导入语句
2. 类型定义 (Props, State)
3. 组件定义
4. 状态声明
5. 副作用 (生命周期)
6. 事件处理函数
7. 渲染逻辑

**核心规则**:
- 🔴 使用函数式组件
- ⚠️ 使用 TypeScript 或类型检查
- 🔴 Props 明确定义类型
- 🔴 状态提升: 共享状态提升至父组件
- 🟡 单一职责: 一个组件只做一件事

**优化规则**:
- 🟡 避免不必要的重渲染 (memo/缓存)
- 🟡 复杂计算使用缓存
- 🟡 事件处理函数使用回调缓存

### 5.3 状态管理 🟡

**状态原则**:
- 🔴 状态最小化: 只存储必要状态
- 🔴 派生数据通过计算得到，不单独存储
- 🔴 避免冗余状态
- 🟡 相关状态合并为对象

**状态分类**:
- 本地状态: 组件内部使用
- 共享状态: 多组件共享
- 服务端状态: API 数据
- URL 状态: 路由参数

**更新规则**:
- 🔴 不可变更新 (创建新对象)
- 🔴 批量更新合并
- 🟡 异步更新使用回调形式

---

## 六、性能规范

### 6.1 渲染优化 🔴

**列表渲染**:
- ⚠️ 必须提供唯一 key (使用 id，不用 index)
- 🔴 数据 > 100 条使用虚拟滚动
- 🟡 避免在渲染函数中创建新对象/函数

**组件优化**:
- 🟡 避免不必要的重渲染
- 🟡 大组件拆分为小组件
- 🟡 复杂计算结果缓存

### 6.2 资源加载 🟡

**懒加载策略**:
- 路由懒加载 (按需加载页面)
- 图片懒加载 (可视区域外延迟加载)
- 组件懒加载 (非首屏组件)

**资源优化**:
- 🔴 图片压缩和格式优化
- 🔴 代码分割和按需加载
- 🟡 关键资源预加载
- 🟡 非关键资源延迟加载

### 6.3 体验优化 🟡

**感知性能**:
- 骨架屏提升加载体验
- 乐观更新提升响应速度
- 防抖节流优化高频操作

**核心指标**:
- 首屏渲染 < 2.5s
- 交互响应 < 100ms
- 布局稳定 (避免闪烁)

---

## 七、无障碍规范

### 7.1 色彩无障碍 🔴

- ⚠️ 文字对比度 ≥ 4.5:1 (WCAG AA)
- 🔴 信息不能仅依赖颜色传达
- 🔴 避免纯红绿对比 (色盲友好)
- 🟡 提供高对比度模式

### 7.2 键盘导航 🔴

- ⚠️ 所有交互元素支持 Tab 键导航
- 🔴 焦点顺序符合视觉顺序
- 🔴 焦点样式清晰可见
- 🔴 支持常用快捷键:
  - Enter: 确认/提交
  - ESC: 关闭/取消
  - Space: 选择
  - 方向键: 导航

### 7.3 语义化 🔴

- 🔴 使用语义化 HTML 标签
- 🔴 图片提供 alt 文本
- 🔴 表单控件关联 label
- 🟡 复杂组件提供 ARIA 属性
- 🔴 页面标题唯一且描述性

---

## 八、代码生成检查清单

### ⚠️ CRITICAL 检查 (必须)

- [ ] 异步操作有 loading 状态
- [ ] 异步操作有错误处理
- [ ] 文字对比度 ≥ 4.5:1
- [ ] 所有间距是 8 的倍数
- [ ] 列表提供唯一 key
- [ ] 所有交互有反馈
- [ ] 主按钮在右侧

### 🔴 MUST 检查 (强制)

- [ ] 使用类型检查 (TypeScript/PropTypes)
- [ ] 组件有类型定义
- [ ] 表单有验证规则
- [ ] 数据 > 10 条有分页
- [ ] 字号 ≥ 12px
- [ ] 按钮高度 ≥ 32px
- [ ] 命名语义化
- [ ] 支持键盘导航

### 🟡 SHOULD 检查 (建议)

- [ ] 长列表虚拟滚动
- [ ] 路由懒加载
- [ ] 图片懒加载
- [ ] 复杂计算缓存
- [ ] 提供快捷键
- [ ] 移动端适配

---

## 九、常见错误规避

### ❌ 禁止行为

**视觉设计**:
- 使用任意像素值 (13px, 27px)
- 主色占比超过 30%
- 对比度低于 4.5:1
- 字号小于 12px

**交互设计**:
- 异步操作无 loading 状态
- 操作无反馈
- 主按钮在左侧
- 按钮文字模糊 ("确定"/"好的")

**代码实现**:
- 异步操作无错误处理
- 列表使用 index 作为 key
- 表单无验证
- 状态管理中存储派生数据
- 条件/循环中使用 Hooks
- 副作用未清理

### ✅ 正确做法

**视觉设计**:
- 间距使用 8 的倍数
- 使用标准色彩系统
- 确保足够对比度
- 字号不小于 12px

**交互设计**:
- 异步操作显示 loading
- 所有操作提供反馈
- 主按钮在右侧
- 按钮使用动词

**代码实现**:
- try-catch 处理错误
- 使用唯一 id 作为 key
- 表单添加验证规则
- 派生数据通过计算
- Hooks 在顶层调用
- 副作用正确清理

---

## 十、快速参考

### 间距阶梯
4 → 8 → 16 → 24 → 32 → 48 → 64 (px)

### 字号阶梯
12 → 14 → 16 → 18 → 20 → 24 (px)

### 响应式断点
xs(<576) → sm(576) → md(768) → lg(992) → xl(1200) → xxl(1600) (px)

### 对话框尺寸
520 (小) → 720 (中) → 960 (大) (px)

### 操作响应时间
<100ms(无需反馈) → 100ms-1s(loading) → 1s-3s(提示) → >3s(进度条)

---

## 核心原则总结

### ⚠️ CRITICAL (违反导致严重问题)
1. 异步操作必须有 loading + 错误处理
2. 文字对比度 ≥ 4.5:1
3. 所有交互必须有反馈
4. 列表必须有唯一 key

### 🔴 MUST (强制执行)
1. 间距使用 8 的倍数
2. 主按钮在右，次按钮在左
3. 使用类型系统 (TypeScript/PropTypes)
4. 表单必须验证
5. 数据 > 10 条必须分页
6. 字号 ≥ 12px
7. 命名语义化
8. 支持键盘导航

### 🟡 SHOULD (强烈建议)
1. 长列表虚拟滚动
2. 路由和组件懒加载
3. 图片懒加载
4. 移动端优先设计
5. 提供快捷键

### 代码生成优先级
1. **功能正确** - 实现需求
2. **类型安全** - 避免运行时错误
3. **错误处理** - 提升健壮性
4. **用户体验** - loading + 反馈
5. **视觉规范** - 符合设计系统

---

**版本**: 2.0  
**更新**: 2026-01-04  
**适用**: 所有主流前端框架
